name: Required Files Check (Pull Request)

on:
  pull_request:
    branches:
      - main

jobs:
  validate-required-files:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Run required files checker
        run: python3 check_required_files.py

      - name: Log results to CloudWatch (Beta)
        run: |
          TIMESTAMP=$(date -u +"%Y-%m-%dT%H:%M:%SZ")
          aws logs create-log-stream \
            --log-group-name "/github-actions/required-files-checker/beta" \
            --log-stream-name "$TIMESTAMP"
          
          aws logs put-log-events \
            --log-group-name "/github-actions/required-files-checker/beta" \
            --log-stream-name "$TIMESTAMP" \
            --log-events "timestamp=$(date +%s)000, message='Required files check completed on PR'"
